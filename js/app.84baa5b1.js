(function(){var t={3805:function(t,e,a){"use strict";var s=a(144),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("router-view")],1)},n=[],r=a(1001),o={},l=(0,r.Z)(o,i,n,!1,null,null,null),c=l.exports,u=(a(6801),a(8345)),d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("van-nav-bar",{attrs:{title:t.activeTitle,fixed:""}}),a("div",{staticClass:"main"},[a("keep-alive",[a("router-view")],1)],1),a("van-tabbar",{attrs:{route:""}},[a("van-tabbar-item",{attrs:{icon:"home-o",replace:"",to:"/layout/home"}},[t._v("首页")]),a("van-tabbar-item",{attrs:{icon:"search",replace:"",to:"/layout/search"}},[t._v("搜索")])],1)],1)},h=[],m={data(){return{activeTitle:this.$route.meta.title}},watch:{$route(){this.activeTitle=this.$route.meta.title}}},p=m,f=(0,r.Z)(p,d,h,!1,null,"4ecace6c",null),v=f.exports,y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("p",{staticClass:"title"},[t._v("推荐歌单")]),a("div",[a("van-row",{attrs:{gutter:"10"}},t._l(t.recommendList,(function(e){return a("van-col",{key:e.id,attrs:{span:"8"}},[a("van-image",{attrs:{width:"100%",height:"3rem",src:e.picUrl}}),a("p",{staticClass:"song_name"},[t._v(t._s(e.name))])],1)})),1)],1),a("p",{staticClass:"title"},[t._v("最新音乐")]),t._l(t.hotList,(function(t){return a("SongItem",{key:t.id,attrs:{name:t.name,author:t.song.artists[0].name,id:t.id}})}))],2)},g=[],_=a(9669),w=a.n(_);const b=w().create({baseURL:"http://localhost:3000"});var C=b;const L=t=>C({url:"/personalized",params:t}),Z=t=>C({url:"/personalized/newsong",params:t}),k=()=>C({url:"/search/hot"}),$=t=>C({url:"/cloudsearch",params:t}),S=t=>C({url:`/song/detail?ids=${t}`,method:"GET"}),x=t=>C({url:`/lyric?id=${t}`,method:"GET"}),E=t=>C({url:"/comment/music",params:t}),I=L,T=Z,O=k,V=$,j=S,q=x,z=E;var U=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("van-cell",{attrs:{title:t.name,label:t.author+" "+t.name,center:""},on:{click:function(e){return t.$router.push({path:"/comment",query:{id:t.id}})}},scopedSlots:t._u([{key:"right-icon",fn:function(){return[a("van-icon",{staticClass:"search-icon",attrs:{name:"play-circle-o"},on:{touchstart:t.playFn}})]},proxy:!0}])})},D=[],F={props:{name:String,author:String,id:Number},methods:{playFn(){this.$router.push({path:"/play",query:{id:this.id}})}}},M=F,N=(0,r.Z)(M,U,D,!1,null,"26bdac8b",null),P=N.exports,G={data(){return{recommendList:[],hotList:[]}},async created(){const t=await I({limit:6});this.recommendList=t.data.result;const e=await T({limit:20});this.hotList=e.data.result},components:{SongItem:P}},R=G,H=(0,r.Z)(R,y,g,!1,null,"7214143c",null),W=H.exports,A=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("van-search",{attrs:{placeholder:"请输入搜索关键词",shape:"round"},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}}),0===t.resultList.length?a("div",{staticClass:"search_wrap"},[a("p",{staticClass:"hot_title"},[t._v("热门搜索")]),a("ul",{staticClass:"hot_name_wrap"},t._l(t.hotList,(function(e,s){return a("li",{key:s,staticClass:"hot_item",on:{click:function(a){return t.btn(e.first)}}},[t._v(" "+t._s(e.first)+" ")])})),0)]):a("div",{staticClass:"search_wrap"},[a("p",{staticClass:"hot_title"},[t._v("最佳匹配")]),t._l(t.resultList,(function(t){return a("SongItem",{key:t.id,attrs:{name:t.name,author:t.ar[0].name,id:t.id}})}))],2)],1)},B=[],J={data(){return{searchValue:"",hotList:[],resultList:[],timer:null}},async created(){const t=await O();this.hotList=t.data.result.hots},methods:{async btn(t){this.searchValue=t;const e=await V({type:1,keywords:this.searchValue});this.resultList=e.data.result.songs,setTimeout((()=>{clearTimeout(this.timer)}))}},watch:{searchValue(t){if(clearTimeout(this.timer),0===t.length)return this.resultList=[];this.timer=setTimeout((async()=>{const e=await V({type:1,keywords:t});this.resultList=e.data.result.songs}),1e3)}},components:{SongItem:P}},K=J,Q=(0,r.Z)(K,A,B,!1,null,"2116957b",null),X=Q.exports,Y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"play"},[a("div",{staticClass:"song-bg",style:"background-image: url("+(t.songInfo&&t.songInfo.al&&t.songInfo.al.picUrl)+"?imageView&thumbnail=360y360&quality=75&tostatic=0);"}),a("div",{staticClass:"header"},[a("van-icon",{staticClass:"left-incon",attrs:{name:"arrow-left",size:"20"},on:{click:function(e){return t.$router.back()}}})],1),a("div",{staticClass:"song-wrapper"},[a("div",{staticClass:"song-turn ani",style:"animation-play-state:"+(t.playState?"running":"paused")},[a("div",{staticClass:"song-img"},[a("img",{staticStyle:{width:"100%"},attrs:{src:(t.songInfo&&t.songInfo.al&&t.songInfo.al.picUrl)+"?imageView&thumbnail=360y360&quality=75&tostatic=0",alt:""}})])]),a("div",{staticClass:"start-box",on:{click:t.audioStart}},[a("span",{directives:[{name:"show",rawName:"v-show",value:!t.playState,expression:"!playState"}],staticClass:"song-start"})]),a("div",{staticClass:"song-msg"},[a("h2",{staticClass:"m-song-h2"},[a("span",{staticClass:"m-song-sname"},[t._v(t._s(t.songInfo.name)+"-"+t._s(t.songInfo&&t.songInfo.ar&&t.songInfo.ar[0].name))])]),a("div",{staticClass:"lrcContent"},[a("p",{staticClass:"lrc"},[t._v(t._s(t.curLyric))])])]),a("div",{staticClass:"needle",style:"transform: rotate("+t.needleDeg+");"})]),a("audio",{ref:"audio",attrs:{preload:"true",src:"https://music.163.com/song/media/outer/url?id="+t.id+".mp3"}})])},tt=[],et=a(1392),at={components:{[et.Z.name]:et.Z},name:"play",data(){return{playState:!1,id:this.$route.query.id,songInfo:{},lyric:{},curLyric:"",lastLy:""}},computed:{needleDeg(){return this.playState?"-7deg":"-38deg"}},methods:{async getSong(){const t=await j(this.id);this.songInfo=t.data.songs[0];const e=await q(this.id),a=e.data.lrc.lyric;this.lyric=this._formatLyr(a),this.curLyric=this.lyric[0]},_formatLyr(t){let e=/\[.+?\]/g,a=t.match(e),s=t.split(/\[.+?\]/).slice(1),i={};return a.forEach(((t,e)=>{let a=60*t.split(":")[0].split("")[2],n="0"===t.split(":")[1].split(".")[0].split("")[0]?t.split(":")[1].split(".")[0].split("")[1]:t.split(":")[1].split(".")[0];i[a+Number(n)]=s[e]})),i},audioStart(){this.playState?this.$refs.audio.pause():this.$refs.audio.play(),this.playState=!this.playState},showLyric(){this.$refs.audio.addEventListener("timeupdate",(()=>{let t=Math.floor(this.$refs.audio.currentTime);this.lyric[t]?(this.curLyric=this.lyric[t],this.lastLy=this.curLyric):this.curLyric=this.lastLy}))}},mounted(){this.getSong(),this.showLyric()}},st=at,it=(0,r.Z)(st,Y,tt,!1,null,"c407d388",null),nt=it.exports,rt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("van-nav-bar",{attrs:{title:"评论",fixed:"","left-arrow":""},on:{"click-left":function(e){return t.$router.back()}}}),a("div",{staticClass:"main"},t._l(t.list,(function(e){return a("van-cell",{key:e.id},[[a("div",{staticClass:"wrap"},[a("div",{staticClass:"img_wrap"},[a("img",{attrs:{src:e.user.avatarUrl,alt:""}})]),a("div",{staticClass:"content_wrap"},[a("div",{staticClass:"header_wrap"},[a("div",{staticClass:"info_wrap"},[a("p",[t._v(t._s(e.user.nickname))]),a("p",[t._v(t._s(e.time))])]),a("div",[t._v(t._s(e.likedCount)+"点赞")])]),a("div",{staticClass:"footer_wrap"},[t._v(" "+t._s(e.content)+" ")])])])]],2)})),1)],1)},ot=[],lt={data(){return{list:[]}},async created(){const t=await z({id:this.$route.query.id,limit:20});this.list=t.data.comments}},ct=lt,ut=(0,r.Z)(ct,rt,ot,!1,null,"c387f144",null),dt=ut.exports;s.Z.use(u.Z);const ht=[{path:"/",redirect:"/layout"},{path:"/layout",redirect:"/layout/home",component:v,children:[{path:"home",component:W,meta:{title:"首页"}},{path:"search",component:X,meta:{title:"搜索"}}]},{path:"/play",component:nt},{path:"/comment",component:dt}],mt=new u.Z({routes:ht});var pt=mt,ft=a(8521),vt=a(2476),yt=a(1914),gt=a(5641),_t=a(6458),wt=a(4951),bt=a(9233),Ct=a(4168),Lt=a(4119);a(415);s.Z.use(ft.Z),s.Z.use(vt.Z),s.Z.use(yt.Z),s.Z.use(gt.Z),s.Z.use(_t.Z),s.Z.use(wt.Z),s.Z.use(bt.Z),s.Z.use(Ct.Z),s.Z.use(et.Z),s.Z.use(Lt.Z),s.Z.config.productionTip=!1,new s.Z({router:pt,render:t=>t(c)}).$mount("#app")},6801:function(){(function(t,e){var a=e.documentElement,s=t.devicePixelRatio||1;function i(){e.body?e.body.style.fontSize=12*s+"px":e.addEventListener("DOMContentLoaded",i)}function n(){var t=a.clientWidth/10;a.style.fontSize=t+"px"}if(i(),n(),t.addEventListener("resize",n),t.addEventListener("pageshow",(function(t){t.persisted&&n()})),s>=2){var r=e.createElement("body"),o=e.createElement("div");o.style.border=".5px solid transparent",r.appendChild(o),a.appendChild(r),1===o.offsetHeight&&a.classList.add("hairlines"),a.removeChild(r)}})(window,document)}},e={};function a(s){var i=e[s];if(void 0!==i)return i.exports;var n=e[s]={exports:{}};return t[s](n,n.exports,a),n.exports}a.m=t,function(){var t=[];a.O=function(e,s,i,n){if(!s){var r=1/0;for(u=0;u<t.length;u++){s=t[u][0],i=t[u][1],n=t[u][2];for(var o=!0,l=0;l<s.length;l++)(!1&n||r>=n)&&Object.keys(a.O).every((function(t){return a.O[t](s[l])}))?s.splice(l--,1):(o=!1,n<r&&(r=n));if(o){t.splice(u--,1);var c=i();void 0!==c&&(e=c)}}return e}n=n||0;for(var u=t.length;u>0&&t[u-1][2]>n;u--)t[u]=t[u-1];t[u]=[s,i,n]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var s in e)a.o(e,s)&&!a.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};a.O.j=function(e){return 0===t[e]};var e=function(e,s){var i,n,r=s[0],o=s[1],l=s[2],c=0;if(r.some((function(e){return 0!==t[e]}))){for(i in o)a.o(o,i)&&(a.m[i]=o[i]);if(l)var u=l(a)}for(e&&e(s);c<r.length;c++)n=r[c],a.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return a.O(u)},s=self["webpackChunkmusic_demo"]=self["webpackChunkmusic_demo"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=a.O(void 0,[998],(function(){return a(3805)}));s=a.O(s)})();
//# sourceMappingURL=app.84baa5b1.js.map